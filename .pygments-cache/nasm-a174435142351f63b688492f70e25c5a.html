<div class="highlight"><pre><span class="nl">.text:</span><span class="err">0040120</span><span class="nf">E</span> <span class="nv">mov</span>     <span class="nb">eax</span><span class="p">,</span> <span class="mh">564D5868h</span>   <span class="c1">; save magic number to eax</span>
<span class="nl">.text:</span><span class="err">00401213</span> <span class="nf">mov</span>     <span class="nb">ecx</span><span class="p">,</span> <span class="mh">0Ah</span>
<span class="nl">.text:</span><span class="err">00401218</span> <span class="nf">mov</span>     <span class="nb">dx</span><span class="p">,</span> <span class="mh">5658h</span>
<span class="nl">.text:</span><span class="err">0040121</span><span class="nf">C</span> <span class="nv">in</span>      <span class="nb">eax</span><span class="p">,</span> <span class="nb">dx</span>          <span class="c1">; if in VMware, this instruction will save the magic number in ebx</span>
<span class="nl">.text:</span><span class="err">0040121</span><span class="nf">D</span> <span class="nv">mov</span>     <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">var_1C</span><span class="p">],</span> <span class="nb">ebx</span>    <span class="c1">; executes if in VMware (no exception is raised)</span>
</pre></div>