<div class="highlight"><pre><span class="nl">.text:</span><span class="err">004019</span><span class="nf">D6</span> <span class="nv">loc_4019D6</span><span class="p">:</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">D6</span> <span class="nv">lea</span>     <span class="nb">edx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">dwNumberOfBytesRead</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">DC</span> <span class="nv">push</span>    <span class="nb">edx</span>             <span class="c1">; lpdwNumberOfBytesRead - Pointer to variable that will hold number of bytes read</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="kd">DD</span> <span class="nv">push</span>    <span class="mh">1000h</span>           <span class="c1">; dwNumberOfBytesToRead - Number of bytes to read 0x1000 == 4096</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">E2</span> <span class="nv">lea</span>     <span class="nb">ecx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">Buffer</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">E8</span> <span class="nv">push</span>    <span class="nb">ecx</span>             <span class="c1">; lpBuffer - Buffer to hold the retrieved data</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">E9</span> <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; hFile - Handle from previous InternetOpenUrl call</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">EA</span> <span class="nv">call</span>    <span class="nb">ds</span><span class="p">:</span><span class="nv">InternetReadFile</span> <span class="c1">; Reading the first 4KBs of the tweet</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">F0</span> <span class="nv">mov</span>     <span class="nb">edx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">dwNumberOfBytesRead</span><span class="p">]</span> <span class="c1">; edx = 0x1000 (4096)</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">F6</span> <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">edi</span><span class="o">+</span><span class="nb">edx</span><span class="p">]</span>  <span class="c1">; eax = 0x1000</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">F9</span> <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; size_t</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">FA</span> <span class="nv">call</span>    <span class="nv">??2@YAPAXI@Z</span>    <span class="c1">; operator new(uint)</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">FF</span> <span class="nv">push</span>    <span class="nb">edi</span>             <span class="c1">; size_t</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A00</span> <span class="nv">mov</span>     <span class="nb">esi</span><span class="p">,</span> <span class="nb">eax</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A02</span> <span class="nv">push</span>    <span class="nb">ebx</span>             <span class="c1">; void *</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A03</span> <span class="nv">push</span>    <span class="nb">esi</span>             <span class="c1">; void *</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A04</span> <span class="nv">call</span>    <span class="nv">_memcpy</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A09</span> <span class="nv">mov</span>     <span class="nb">ecx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">dwNumberOfBytesRead</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A0F</span> <span class="nv">push</span>    <span class="nb">ecx</span>             <span class="c1">; size_t</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A10</span> <span class="nv">lea</span>     <span class="nb">edx</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">Buffer</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A16</span> <span class="nv">push</span>    <span class="nb">edx</span>             <span class="c1">; void *</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A17</span> <span class="nv">lea</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">esi</span><span class="o">+</span><span class="nb">edi</span><span class="p">]</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A1A</span> <span class="nv">push</span>    <span class="nb">eax</span>             <span class="c1">; void *</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A1B</span> <span class="nv">call</span>    <span class="nv">_memcpy</span>         <span class="c1">; Copy retrieved data to [eax]</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A20</span> <span class="nv">push</span>    <span class="nb">ebx</span>             <span class="c1">; void *</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A21</span> <span class="nv">call</span>    <span class="nv">??3@YAXPAX@Z</span>    <span class="c1">; operator delete(void *)</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A26</span> <span class="nv">mov</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">dwNumberOfBytesRead</span><span class="p">]</span> <span class="c1">; eax = 0x1000</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A2C</span> <span class="nv">add</span>     <span class="nb">esp</span><span class="p">,</span> <span class="mh">20h</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A2F</span> <span class="nv">add</span>     <span class="nb">edi</span><span class="p">,</span> <span class="nb">eax</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A31</span> <span class="nv">mov</span>     <span class="nb">ebx</span><span class="p">,</span> <span class="nb">esi</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A33</span> <span class="nv">test</span>    <span class="nb">eax</span><span class="p">,</span> <span class="nb">eax</span>        <span class="c1">; Check to see if request was successful</span>
<span class="nl">.text:</span><span class="err">00401</span><span class="nf">A35</span> <span class="nv">jnz</span>     <span class="nv">short</span> <span class="nv">loc_4019D0</span> <span class="c1">; if (NumberofBytesRead !=0 ) jump to loc_4019D0</span>

<span class="nl">.text:</span><span class="err">004019</span><span class="nf">D0</span> <span class="nv">loc_4019D0</span><span class="p">:</span>
<span class="nl">.text:</span><span class="err">004019</span><span class="nf">D0</span> <span class="nv">mov</span>     <span class="nb">eax</span><span class="p">,</span> <span class="p">[</span><span class="nb">ebp</span><span class="o">+</span><span class="nv">hInternet</span><span class="p">]</span> <span class="c1">; Back to the top with</span>
</pre></div>