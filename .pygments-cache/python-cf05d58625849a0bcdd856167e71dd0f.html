<div class="highlight"><pre><span class="n">key1</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;oh happy dayz&#39;</span>
<span class="n">key1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;the final countdown&#39;</span>
 
<span class="n">key2</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;UNACCEPTABLE!&#39;</span>
<span class="n">key2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;omglob&#39;</span>
 
<span class="n">key3</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;you</span><span class="se">\x27</span><span class="s">re so good&#39;</span>
<span class="n">key3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;you</span><span class="se">\x27</span><span class="s">re so bad&#39;</span>
 
<span class="n">key4</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key4</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x66</span><span class="s">&#39;</span>
<span class="n">key4</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x01</span><span class="s">&#39;</span>
 
<span class="n">key5</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;Sandboxes are fun to play in&#39;</span>
<span class="n">key5</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;I</span><span class="se">\x27</span><span class="s">m gonna sandbox your face&#39;</span>
 
<span class="n">key6</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key6</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;I can haz decode?&#39;</span>
<span class="n">key6</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;Such fire. Much burn. Wow.&#39;</span>
 
<span class="n">key7</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x09\x00\x00\x01</span><span class="s">&#39;</span>
<span class="n">key7</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;Feel the sting of the Monarch!&#39;</span>
 
<span class="n">key8</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;! 50 1337&#39;</span>
<span class="n">key8</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;1337&#39;</span>
 
<span class="n">key9</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key9</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;LETS GO SHOPPING&#39;</span>
<span class="n">key9</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;MATH IS HARD&#39;</span>
 
<span class="n">key10</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key10</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;LETS GO MATH&#39;</span>
<span class="n">key10</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;SHOPPING IS HARD&#39;</span>
 
<span class="n">key11</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key11</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x01\x02\x03\x05\x00\x78\x30\x38\x0d</span><span class="s">&#39;</span>
<span class="n">key11</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x07\x77</span><span class="s">&#39;</span>

<span class="n">key12</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;backdoge.exe&quot;</span>
<span class="n">key12</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span>
 
<span class="n">key13</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key13</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;192.203.230.10&#39;</span>
<span class="n">key13</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">&#39;</span>
 
<span class="n">key14</span><span class="o">=</span><span class="p">{}</span>
<span class="n">key14</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="se">\x00</span><span class="s">&#39;</span>
<span class="n">key14</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;jackRAT&#39;</span>

<span class="n">index</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
    <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<span class="c"># we want this to support variable length keys</span>
<span class="c"># so if the key is smaller than data, it will wrap around</span>
<span class="k">def</span> <span class="nf">xor</span><span class="p">(</span><span class="n">mydata</span><span class="p">,</span><span class="n">mykey</span><span class="p">):</span>
    <span class="n">keylen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mykey</span><span class="p">)</span>
    <span class="n">datalen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
    
    <span class="c"># easier to just extend the key array, but probably not that memory efficient</span>
    <span class="c"># not that we care about it here ;)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">mykey</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">datalen</span><span class="o">/</span><span class="n">keylen</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">)</span> 
    
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">^</span> <span class="nb">ord</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">mydata</span><span class="p">,</span><span class="n">key</span><span class="p">))</span>


<span class="kn">from</span> <span class="nn">binascii</span> <span class="kn">import</span> <span class="n">hexlify</span><span class="p">,</span> <span class="n">unhexlify</span>

<span class="n">myfile</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="s">&#39;c:</span><span class="se">\\</span><span class="s">extractedgratz.exe&#39;</span><span class="p">,</span><span class="s">&#39;rb&#39;</span><span class="p">)</span>

<span class="n">wholefile</span> <span class="o">=</span> <span class="n">myfile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">wholefile</span><span class="p">[:</span><span class="mh">0x10</span><span class="p">]</span>

<span class="n">myfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
          <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
              <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                  <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                      <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                          <span class="k">for</span> <span class="n">index</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key1</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key2</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key3</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key4</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key5</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key6</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key7</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">7</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key8</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">8</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key9</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">9</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key10</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">10</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key11</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">11</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key12</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">12</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key13</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">13</span><span class="p">]])</span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key14</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="mi">14</span><span class="p">]])</span>
                            
                            <span class="k">if</span> <span class="p">(</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;M&#39;</span> <span class="ow">and</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Z&#39;</span><span class="p">):</span>
                              <span class="k">print</span> <span class="s">&quot;Found it&quot;</span>
                              <span class="k">print</span> <span class="n">out</span>
                              <span class="k">print</span> <span class="n">hexlify</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
                          
                              <span class="n">out</span> <span class="o">=</span> <span class="n">wholefile</span>
                              
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key1</span><span class="p">[</span><span class="n">ind1</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key2</span><span class="p">[</span><span class="n">ind2</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key3</span><span class="p">[</span><span class="n">ind3</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key4</span><span class="p">[</span><span class="n">ind4</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key5</span><span class="p">[</span><span class="n">ind5</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key6</span><span class="p">[</span><span class="n">ind6</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key7</span><span class="p">[</span><span class="n">ind7</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key8</span><span class="p">[</span><span class="n">ind8</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key9</span><span class="p">[</span><span class="n">ind9</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key10</span><span class="p">[</span><span class="n">ind10</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key11</span><span class="p">[</span><span class="n">ind11</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key13</span><span class="p">[</span><span class="n">ind13</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">key14</span><span class="p">[</span><span class="n">ind14</span><span class="p">])</span>
                              <span class="n">out</span> <span class="o">=</span> <span class="n">xor</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="s">&#39;backdoge.exe&#39;</span><span class="p">)</span>
                          
                              <span class="n">decodedfilename</span> <span class="o">=</span> <span class="s">&quot;c:</span><span class="se">\\</span><span class="s">gratz&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.exe&quot;</span>
                              <span class="n">decodedfile</span> <span class="o">=</span> <span class="nb">file</span><span class="p">(</span><span class="n">decodedfilename</span><span class="p">,</span><span class="s">&#39;wb&#39;</span><span class="p">)</span>
                              <span class="n">decodedfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
                              <span class="n">decodedfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                                
                            <span class="c"># be sure to reset the wholefile after reading it, thanks Curtis :)                                                                  </span>
                            <span class="n">out</span> <span class="o">=</span> <span class="n">wholefile</span><span class="p">[:</span><span class="mh">0x10</span><span class="p">]</span>
                            <span class="n">counter</span> <span class="o">+=</span><span class="mi">1</span>
</pre></div>