<div class="highlight"><pre><span class="n">using</span> <span class="n">System</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Linq</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Text</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Threading</span><span class="o">.</span><span class="n">Tasks</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">Remoting</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">Remoting</span><span class="o">.</span><span class="n">Channels</span><span class="p">;</span>
<span class="n">using</span> <span class="n">System</span><span class="o">.</span><span class="n">Runtime</span><span class="o">.</span><span class="n">Remoting</span><span class="o">.</span><span class="n">Channels</span><span class="o">.</span><span class="n">Tcp</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">RemotingSample</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Server</span>
    <span class="p">{</span>
        <span class="n">static</span> <span class="n">void</span> <span class="n">Main</span><span class="p">(</span><span class="n">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">TCP</span> <span class="n">channel</span> <span class="ow">and</span> <span class="n">bind</span> <span class="n">it</span> <span class="n">to</span> <span class="n">port</span> <span class="mi">8888</span>
            <span class="n">TcpChannel</span> <span class="n">remotingChannel</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TcpChannel</span><span class="p">(</span><span class="mi">8888</span><span class="p">);</span>

            <span class="o">//</span> <span class="n">register</span> <span class="n">the</span> <span class="n">channel</span><span class="p">,</span> <span class="n">the</span> <span class="n">second</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="n">ensureSecurity</span>
            <span class="o">//</span> <span class="n">I</span> <span class="n">have</span> <span class="nb">set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">false</span> <span class="n">to</span> <span class="n">disable</span> <span class="n">encryption</span> <span class="ow">and</span> <span class="n">signing</span>
            <span class="o">//</span> <span class="k">for</span> <span class="n">more</span> <span class="n">information</span> <span class="n">see</span> <span class="n">section</span> <span class="n">Remarks</span> <span class="ow">in</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">msdn</span><span class="o">.</span><span class="n">microsoft</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">en</span><span class="o">-</span><span class="n">us</span><span class="o">/</span><span class="n">library</span><span class="o">/</span><span class="n">ms223155</span><span class="p">(</span><span class="n">v</span><span class="o">=</span><span class="n">vs</span><span class="o">.</span><span class="mi">90</span><span class="p">)</span><span class="o">.</span><span class="n">aspx</span>
            <span class="n">ChannelServices</span><span class="o">.</span><span class="n">RegisterChannel</span><span class="p">(</span><span class="n">remotingChannel</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>

            <span class="o">//</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">servicetype</span> <span class="n">of</span> <span class="nb">type</span> <span class="n">RemoteMath</span> <span class="n">named</span> <span class="s">&quot;rMath&quot;</span> <span class="ow">and</span> <span class="n">of</span> <span class="nb">type</span> <span class="n">SingleCall</span>
            <span class="o">//</span> <span class="n">SingleCall</span><span class="p">:</span> <span class="n">a</span> <span class="n">new</span> <span class="nb">object</span> <span class="n">will</span> <span class="n">be</span> <span class="n">created</span> <span class="k">for</span> <span class="n">each</span> <span class="n">call</span>
            <span class="o">//</span> <span class="k">as</span> <span class="n">opposed</span> <span class="n">to</span> <span class="n">WellKnownObjectMode</span><span class="o">.</span><span class="n">Singleton</span> <span class="n">where</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">one</span> <span class="nb">object</span> <span class="k">for</span> <span class="nb">all</span> <span class="n">calls</span> <span class="p">(</span><span class="ow">and</span> <span class="n">clients</span><span class="p">)</span>
            <span class="n">WellKnownServiceTypeEntry</span> <span class="n">remoteObject</span> <span class="o">=</span> <span class="n">new</span> <span class="n">WellKnownServiceTypeEntry</span><span class="p">(</span><span class="n">typeof</span><span class="p">(</span><span class="n">RemoteMath</span><span class="p">),</span> <span class="s">&quot;rMath&quot;</span><span class="p">,</span> <span class="n">WellKnownObjectMode</span><span class="o">.</span><span class="n">SingleCall</span><span class="p">);</span>

            <span class="o">//</span> <span class="n">register</span> <span class="n">the</span> <span class="n">remoteObject</span> <span class="n">servicetype</span>
            <span class="n">RemotingConfiguration</span><span class="o">.</span><span class="n">RegisterWellKnownServiceType</span><span class="p">(</span><span class="n">remoteObject</span><span class="p">);</span>

            <span class="n">Console</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Registered service&quot;</span><span class="p">);</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&quot;Press any key to exit&quot;</span><span class="p">);</span>
            <span class="n">Console</span><span class="o">.</span><span class="n">ReadLine</span><span class="p">();</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>