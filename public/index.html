
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Parsiya's Den</title>
  <meta name="author" content="Parsiya">

  
  <meta name="description" content="In part 1 I talked about identifying Hipchat endpoints and promised to discuss proxying the application. In this post I will show how to proxy some &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://parsiya.net">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Parsiya's Den" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- start image popup stuff -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

<!-- end image popup stuff -->

<!-- Look at me, I am looking at source!!11! -->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55491306-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Parsiya's Den</a></h1>
  
    <h2>Because no one wants to be the other guy in Wham!</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:parsiya.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <!-- <li><a href="/about.html">About Me</a></li> -->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/">Proxying Hipchat Part 2: So You Think You Can Use Burp?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-09T22:34:37-04:00" pubdate data-updated="true">Oct 9<span>th</span>, 2015</time>
        
           | <a href="/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="../2015-10-08-hipchat-part-1-where-did-the-traffic-go"><strong>part 1</strong></a> I talked about identifying Hipchat endpoints and promised to discuss proxying the application. In this post I will show how to proxy <em>some</em> of Hipchat’s traffic using Burp.</p>

<p>This is specific to Hipchat client for Windows. The current version at the time of writing was is <strong>2.2.1361</strong>. Atlassian is skipping version 3 and version 4 still in beta.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015-10-08-hipchat-part-1-where-did-the-traffic-go/">Proxying Hipchat Part 1: Where Did the Traffic Go?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-08T23:05:24-04:00" pubdate data-updated="true">Oct 8<span>th</span>, 2015</time>
        
           | <a href="/blog/2015-10-08-hipchat-part-1-where-did-the-traffic-go/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2015-10-08-hipchat-part-1-where-did-the-traffic-go/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This is a slightly different version of a series of blog post that I wrote on our internal blog about proxying. I see that proxying traffic is a time consuming step in testing thick client applications so I thought I would share what I know. I tackled Hipchat. Why Hipchat? Because it uses a known protocol (XMPP) and I thought it’s an interesting application.</p>

<p>I used Hipchat Windows client version 2. At the time of writing version 4 is in beta. In this part we will see how we can identify endpoints from traffic captures even when they are behind a load balancer/shared hosting etc. In next parts we will start proxying.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015-10-08-hipchat-part-1-where-did-the-traffic-go/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015-08-01-network-traffic-attribution-on-windows/">Network Traffic Attribution on Windows</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-01T19:37:42-04:00" pubdate data-updated="true">Aug 1<span>st</span>, 2015</time>
        
           | <a href="/blog/2015-08-01-network-traffic-attribution-on-windows/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2015-08-01-network-traffic-attribution-on-windows/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Thick client assessments come in different flavors. Most of our work is on <code>consumer applications</code> where <code>consumer</code> means either the customer or an employee of our client. But these applications usually have network communications.</p>

<p>When looking at thick client applications from a network traffic perspective, we face two big challenges:</p>

<ol>
  <li>
    <p><strong>Traffic Attribution</strong> or <strong>Where does this traffic come from?</strong>: How to we identify application’s traffic? The operating system (in this case Windows) is running many applications and services. Each of them may have network connectivity.</p>
  </li>
  <li>
    <p><strong>Proxying Traffic</strong> or <strong>How do I look view/modify traffic?</strong>: This is more challenging and involves capturing, modifying and in a lot of cases decrypting/decoding target application’s traffic. This could be as easy as setting up Burp via an application setting (EZ-mode) or as hard as setting up your own access point to capture a device’s traffic then developing your own decryption plugin for your proxy tool (good luck).</p>
  </li>
</ol>

<p>In this post, I will be talking about the much easier first challenge. I will be talking about some of the tools and techniques that I use to accomplish this. This is not a groundbreaking post ;). We will use a simple application, in this case <code>notepad++</code>.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015-08-01-network-traffic-attribution-on-windows/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015-07-26-image-popup-and-octopress/">Image Popup and Octopress</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-07-26T23:02:58-04:00" pubdate data-updated="true">Jul 26<span>th</span>, 2015</time>
        
           | <a href="/blog/2015-07-26-image-popup-and-octopress/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2015-07-26-image-popup-and-octopress/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I finally realized that I need an image popup plugin. The image plugins that I usually use do not support this. They are fine for normal images but not for larger ones. When I see an screenshot of a tool, I want to be able to zoom in. In my quest I looked at a few plugins and methods and finally decided to use <a href="https://github.com/ctdk/octopress-image-popup">https://github.com/ctdk/octopress-image-popup</a>. It creates resized thumbnails automatically and the installation procedure is short and simple.</p>

<p>However, it did not work for me out of the box. I created a test post with just an image and while the plugin worked, there are things that I did not like about it.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015-07-26-image-popup-and-octopress/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015-01-06-tales-from-the-crypt-o-leaking-aes-keys/">Tales From the Crypt(o) - Leaking AES Keys</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-06T23:36:48-05:00" pubdate data-updated="true">Jan 6<span>th</span>, 2015</time>
        
           | <a href="/blog/2015-01-06-tales-from-the-crypt-o-leaking-aes-keys/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2015-01-06-tales-from-the-crypt-o-leaking-aes-keys/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This post is part one of a two part internal blog entry on creating a Pintool for an assessment. Unfortunately I cannot talk about it, so I decided to put the first part out. If I find an opensource program similar to the assessment I will try and recreate the tool (but I am not holding my breath). As this part is essentially a build up, it may not be coherent at times. Alterntively, if you really want to read it, you can join us. We are almost always hiring (let me do the referal though ;).</p>

<p>Today we are going to talk about discovering encryption keys in sneaky ways. We will start with simple examples, do a bit of Digital Forensics or DF (for low standards of DF) and finally in part two we will use our recently acquired knowledge of Pintool to do <code>[redacted]</code>. </p>

<p>First let’s talk a bit about the inner-workings of AES decryption. By inner-workings of AES I do not mean the following diagrams that you have seen so many times.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015-01-06-tales-from-the-crypt-o-leaking-aes-keys/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/">Pin Adventures - Chapter 1 - PinSolver Mk1</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-08T20:46:59-05:00" pubdate data-updated="true">Dec 8<span>th</span>, 2014</time>
        
           | <a href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>While writing the writeups for the <a href="http://parsiya.net/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/#ch6">Flare On Challenge 6</a> I came upon <a href="http://gaasedelen.blogspot.com/2014/09/solving-fireeyes-flare-on-six-via-side.html">an alternative solution</a> by <a href="https://twitter.com/gaasedelen">@gaasedelen</a> to use the number of executed instructions as a side-channel. Recently during an engagement I used <a href="https://software.intel.com/en-us/articles/pintool">Pintool</a> to do <code>[redacted]</code>. Now that I have a bit of time, I decided to use the idea to write such a tool.</p>

<p>As an example, we will use a C program that checks input for a hardcoded value using <code>strncmp</code>. We want to see if it’s vulnerable to this side-channel (number of executed instructions).</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-11-18-building-memfetch-on-kali/">Building Memfetch on Kali + Comments</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-18T23:21:01-05:00" pubdate data-updated="true">Nov 18<span>th</span>, 2014</time>
        
           | <a href="/blog/2014-11-18-building-memfetch-on-kali/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2014-11-18-building-memfetch-on-kali/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve used Disqus to add comments. At the moment, guests can comment and comments do not need to be approved (unless they have links). Hopefully there won’t be much spam to sink the ocassional comment that I think will be posted.</p>

<p>Note: I just wanted to make it work in a hurry. There are probably better ways of doing this.</p>

<p>I stumbled upon the very useful tool <a href="http://lcamtuf.coredump.cx/soft/memfetch.tgz">memfetch</a> by the talented <em>lcamtuf</em>. The utility is quite old (from 2003 if I recall correctly) and I could not build it using the provided makefile.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014-11-18-building-memfetch-on-kali/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/">My Adventure With Fireeye FLARE Challenge</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-07T02:31:44-04:00" pubdate data-updated="true">Oct 7<span>th</span>, 2014</time>
        
           | <a href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>These are my (rather long) solutions to Fireeye’s FLARE challenge. This is just not the solution but other ways that I tried. This was a great learning experience for me so I am writing this post to document everything I tried. As a result, this post is somewhat long.</p>

<p>If you have any feedback, please let me know. I spent a lot of time on this writeup and I am always happy to learn new stuff. My email and twitter handle are in the sidebar.</p>

<p>I am a bit late to the party. There <del>were two</del> are now other three solutions posted (that I know of). Check them out.</p>

<ul>
  <li><a href="https://www.codeandsec.com/Detailed-Solutions-to-FireEye-FLARE-Challenge">Detailed Solutions to FireEye FLARE Challenge</a></li>
  <li><a href="http://www.ghettoforensics.com/2014/09/a-walkthrough-for-flare-re-challenges.html">A Walk through for FLARE RE Challenges</a></li>
  <li>The FLARE On Challenge Solutions by Fireye
    <ul>
      <li><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2014/11/the-flare-on-challenge-solutions-part-1-of-2.html">Part 1 - solutions for challenges 1 to 5</a></li>
      <li><a href="https://www.fireeye.com/blog/threat-research/2014/11/flare_on_challengep.html">Part 2 - solutions for challenges 6 and 7</a></li>
    </ul>
  </li>
</ul>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/">Would you like to know more? &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-09-21-malware-adventure/">Malware Adventure</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-21T19:11:43-04:00" pubdate data-updated="true">Sep 21<span>st</span>, 2014</time>
        
           | <a href="/blog/2014-09-21-malware-adventure/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2014-09-21-malware-adventure/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I finally caved in and started to push some of my code to <del>github</del> bitbucket. It is located at <a href="https://bitbucket.org/parsiya">https://bitbucket.org/parsiya</a> and is almost empty ;).</p>

<p>This is Malware Adventure. It’s a small adventure game I wrote using PAWS. PAWS is Pyhton Adventure Writing System by Roger Plowman. Get it from <a href="http://home.fuse.net/wolfonenet/PAWS.htm">http://home.fuse.net/wolfonenet/PAWS.htm</a>. It’s great.</p>

<p>The game itself is a Python program. You define objects which can be be rooms, items etc. You can read more about it in the readme file at <a href="https://bitbucket.org/parsiya/MalwareAdventure">https://bitbucket.org/parsiya/MalwareAdventure</a>.</p>

<p>PS: Yes, I should be working on the Flare-On challenge writeup. It needs more time because I am not only documenting my solution but what other stuff I did. I think failed attempts are as important as the solution in challenge writeups.</p>

<p>PPS: Changed links to <code>bitbucket</code> as I stopped using github.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-09-02-fireeyes-flare-challenge/">Fireeye&#8217;s FLARE Challenge</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-02T00:34:00-04:00" pubdate data-updated="true">Sep 2<span>nd</span>, 2014</time>
        
           | <a href="/blog/2014-09-02-fireeyes-flare-challenge/#disqus_thread"
             data-disqus-identifier="http://parsiya.net/blog/2014-09-02-fireeyes-flare-challenge/">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>It’s been a while. I know I should have updated more frequently but lazyness prevails.<br />
Anyway, I was busy doing Fireeye’s FlARE challenges for a month or so (it was depressing to see people finish in 10 hours :). You can find the challenges at <a href="http://flare-on.com">http://flare-on.com</a>. I learned a lot doing them. They will release solutions in 2 weeks. I am also working on a writeup which I will release then. I think it will be interesting as it will be a n00b’s perspective.</p>

<p>And finally. “Good news everyone!” I am transitioning a more reverse engineering oriented role at my day job. YAY :)</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Who am I?</h1>
  <p>I am Parsia Hakimian, ex-dev and current (mostly) software security consultant at <a href="http://www.cigital.com/" target="_blank">Cigital</a> .</p>
  <p>I am interested in Reverse Engineering, Crypto, Assembly, C, Python, EvE Online and other things (not necessarily in that order).</p>
  <p>bitbucket: <a href="https://bitbucket.org/parsiya/" target="_blank">https://bitbucket.org/parsiya/</a></p>
  <p>email: parsiya [at] google&#8217;s email [dot]com</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/">Proxying Hipchat Part 2: So You Think You Can Use Burp?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-10-08-hipchat-part-1-where-did-the-traffic-go/">Proxying Hipchat Part 1: Where Did the Traffic Go?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-08-01-network-traffic-attribution-on-windows/">Network Traffic Attribution on Windows</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-07-26-image-popup-and-octopress/">Image Popup and Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015-01-06-tales-from-the-crypt-o-leaking-aes-keys/">Tales From the Crypt(o) - Leaking AES Keys</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/">Pin Adventures - Chapter 1 - PinSolver Mk1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-11-18-building-memfetch-on-kali/">Building Memfetch on Kali + Comments</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/">My Adventure With Fireeye FLARE Challenge</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-21-malware-adventure/">Malware Adventure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-02-fireeyes-flare-challenge/">Fireeye&#8217;s FLARE Challenge</a>
      </li>
    
  </ul>
</section>
<section>
    <h1>Twitter</h1>
    <a class="twitter-timeline"  href="https://twitter.com/CryptoGangsta"  data-widget-id="458841047112482817">Tweets by @CryptoGangsta</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Parsiya -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'parsiya';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
