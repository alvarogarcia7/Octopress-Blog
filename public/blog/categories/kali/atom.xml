<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Kali | Parsiya's Den]]></title>
  <link href="http://parsiya.net/blog/categories/kali/atom.xml" rel="self"/>
  <link href="http://parsiya.net/"/>
  <updated>2015-01-05T08:13:31-05:00</updated>
  <id>http://parsiya.net/</id>
  <author>
    <name><![CDATA[Parsiya]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Building Memfetch on Kali + Comments]]></title>
    <link href="http://parsiya.net/blog/2014-11-18-building-memfetch-on-kali/"/>
    <updated>2014-11-18T23:21:01-05:00</updated>
    <id>http://parsiya.net/blog/building-memfetch-on-kali</id>
    <content type="html"><![CDATA[<p>I’ve used Disqus to add comments. At the moment, guests can comment and comments do not need to be approved (unless they have links). Hopefully there won’t be much spam to sink the ocassional comment that I think will be posted.</p>

<p>Note: I just wanted to make it work in a hurry. There are probably better ways of doing this.</p>

<p>I stumbled upon the very useful tool <a href="http://lcamtuf.coredump.cx/soft/memfetch.tgz">memfetch</a> by the talented <em>lcamtuf</em>. The utility is quite old (from 2003 if I recall correctly) and I could not build it using the provided makefile.</p>

<!-- more -->

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>make
</span><span class='line'>gcc -Wall -O9    memfetch.c   -o memfetch
</span><span class='line'>memfetch.c:30:22: fatal error: asm/page.h: No such file or directory
</span><span class='line'>compilation terminated.
</span><span class='line'>make: *** <span class="o">[</span>memfetch<span class="o">]</span> Error 1
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Seems like the location of header files have moved since then. <a href="http://stackoverflow.com/a/19310710">This stackoverflow answer</a> mentions removing <code>asm/page.h</code> and adding <code>linux/types.h</code>. Let’s see what happens now:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>make
</span><span class='line'>gcc -Wall -O9    memfetch.c   -o memfetch
</span><span class='line'>memfetch.c: In <span class="k">function</span> ‘main’:
</span><span class='line'>memfetch.c:284:25: error: ‘PAGE_SIZE’ undeclared <span class="o">(</span>first use in this <span class="k">function</span><span class="o">)</span>
</span><span class='line'>memfetch.c:284:25: note: each undeclared identifier is reported only once <span class="k">for </span>each <span class="k">function </span>it appears in
</span><span class='line'>make: *** <span class="o">[</span>memfetch<span class="o">]</span> Error 1
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>The <code>page.h</code> file is located at <code>/usr/src/linux-headers-3.12-kali1-common/include/asm-generic/page.h</code> on Kali linux. This is where <code>PAGE_SIZE</code> is defined. Just adding it to <code>memfetch.c</code> along with changing <code>#include &lt;asm/page.h&gt;</code> to <code>#include &lt;linux/types.h&gt;</code> will do the trick.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>// #include &lt;asm/page.h&gt;
</span><span class='line'>#include &lt;linux/types.h&gt;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>// Copied from asm-generic/page.h
</span><span class='line'>/* PAGE_SHIFT determines the page size */
</span><span class='line'>#define PAGE_SHIFT	12
</span><span class='line'>#ifdef &lt;strong>ASSEMBLY&lt;/strong>
</span><span class='line'>#define PAGE_SIZE	(1 « PAGE_SHIFT)
</span><span class='line'>#else
</span><span class='line'>#define PAGE_SIZE	(1UL « PAGE_SHIFT)
</span><span class='line'>#endif
</span><span class='line'>#define PAGE_MASK	(~(PAGE_SIZE-1))</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>If there is a better way to make this work, please let me know.</p>
]]></content>
  </entry>
  
</feed>
