
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Building Memfetch on Kali + Comments - Parsiya's Den</title>
  <meta name="author" content="Parsiya">

  
  <meta name="description" content="I’ve used Disqus to add comments. At the moment, guests can comment and comments do not need to be approved (unless they have links). Hopefully there &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://parsiya.net/blog/2014-11-18-building-memfetch-on-kali">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Parsiya's Den" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-55491306-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Parsiya's Den</a></h1>
  
    <h2>A n00b reverser's adventures down the rabbit hole.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:parsiya.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <!-- <li><a href="/about.html">About Me</a></li> -->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Building Memfetch on Kali + Comments</h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-18T23:21:01-05:00" pubdate data-updated="true">Nov 18<span>th</span>, 2014</time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://parsiya.net">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>I’ve used Disqus to add comments. At the moment, guests can comment and comments do not need to be approved (unless they have links). Hopefully there won’t be much spam to sink the ocassional comment that I think will be posted.</p>

<p>Note: I just wanted to make it work in a hurry. There are probably better ways of doing this.</p>

<p>I stumbled upon the very useful tool <a href="http://lcamtuf.coredump.cx/soft/memfetch.tgz">memfetch</a> by the talented <em>lcamtuf</em>. The utility is quite old (from 2003 if I recall correctly) and I could not build it using the provided makefile.</p>

<!-- more -->

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>make
</span><span class="line">gcc -Wall -O9    memfetch.c   -o memfetch
</span><span class="line">memfetch.c:30:22: fatal error: asm/page.h: No such file or directory
</span><span class="line">compilation terminated.
</span><span class="line">make: *** <span class="o">[</span>memfetch<span class="o">]</span> Error 1
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Seems like the location of header files have moved since then. <a href="http://stackoverflow.com/a/19310710">This stackoverflow answer</a> mentions removing <code>asm/page.h</code> and adding <code>linux/types.h</code>. Let’s see what happens now:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>make
</span><span class="line">gcc -Wall -O9    memfetch.c   -o memfetch
</span><span class="line">memfetch.c: In <span class="k">function</span> ‘main’:
</span><span class="line">memfetch.c:284:25: error: ‘PAGE_SIZE’ undeclared <span class="o">(</span>first use in this <span class="k">function</span><span class="o">)</span>
</span><span class="line">memfetch.c:284:25: note: each undeclared identifier is reported only once <span class="k">for </span>each <span class="k">function </span>it appears in
</span><span class="line">make: *** <span class="o">[</span>memfetch<span class="o">]</span> Error 1
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The <code>page.h</code> file is located at <code>/usr/src/linux-headers-3.12-kali1-common/include/asm-generic/page.h</code> on Kali linux. This is where <code>PAGE_SIZE</code> is defined. Just adding it to <code>memfetch.c</code> along with changing <code>#include &lt;asm/page.h&gt;</code> to <code>#include &lt;linux/types.h&gt;</code> will do the trick.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class=""><span class="line">// #include &lt;asm/page.h&gt;
</span><span class="line">#include &lt;linux/types.h&gt;
</span><span class="line">
</span><span class="line">// Copied from asm-generic/page.h
</span><span class="line">/* PAGE_SHIFT determines the page size */
</span><span class="line">#define PAGE_SHIFT	12
</span><span class="line">#ifdef __ASSEMBLY__
</span><span class="line">#define PAGE_SIZE	(1 &lt;&lt; PAGE_SHIFT)
</span><span class="line">#else
</span><span class="line">#define PAGE_SIZE	(1UL &lt;&lt; PAGE_SHIFT)
</span><span class="line">#endif
</span><span class="line">#define PAGE_MASK	(~(PAGE_SIZE-1))</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>If there is a better way to make this work, please let me know.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Parsiya</span></span>

      








  


<time datetime="2014-11-18T23:21:01-05:00" pubdate data-updated="true">Nov 18<span>th</span>, 2014</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/kali/'>Kali</a>, <a class='category' href='/blog/categories/memfetch/'>Memfetch</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/" title="Previous Post: My Adventure with Fireeye FLARE Challenge">&laquo; My Adventure with Fireeye FLARE Challenge</a>
      
      
        <a class="basic-alignment right" href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/" title="Next Post: Pin Adventures - Chapter 1 - PinSolver Mk1">Pin Adventures - Chapter 1 - PinSolver Mk1 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Who am I?</h1>
  <p>I am Parsia Hakimian, ex-dev and current (mostly) software security consultant at <a href="http://www.cigital.com/" target="_blank">Cigital</a> .</p>
  <p>I am interested in Reverse Engineering, Crypto, Assembly, C, Python, EvE Online and other things (not necessarily in that order).</p>
  <p>bitbucket: <a href="https://bitbucket.org/parsiya/" target="_blank">https://bitbucket.org/parsiya/</a></p>
  <p>email: parsiya [at] google's email [dot]com</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/">Pin Adventures - Chapter 1 - PinSolver Mk1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-11-18-building-memfetch-on-kali/">Building Memfetch on Kali + Comments</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/">My Adventure With Fireeye FLARE Challenge</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-21-malware-adventure/">Malware Adventure</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-02-fireeyes-flare-challenge/">Fireeye's FLARE Challenge</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-07-03-apples-common-crypto-library-defaults-to-a-zero-iv-if-one-is-not-provided/">Apple's Common Crypto Library Defaults to a Zero IV if One Is Not Provided</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-06-25-piping-ssl-slash-tls-traffic-from-soapui-through-burp/">Piping SSL/TLS Traffic From SoapUI to Burp</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-05-25-pasting-shellcode-into-gdb-using-python/">Pasting Shellcode in GDB Using Python</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-04-22-amazon-s3-and-css/">Amazon S3 and CSS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-04-20-now-hosted-on-amazon-s3/">Now Hosted on Amazon S3</a>
      </li>
    
  </ul>
</section>
<section>
    <h1>Twitter</h1>
    <a class="twitter-timeline"  href="https://twitter.com/CryptoGangsta"  data-widget-id="458841047112482817">Tweets by @CryptoGangsta</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Parsiya -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'parsiya';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://parsiya.net/blog/2014-11-18-building-memfetch-on-kali/';
        var disqus_url = 'http://parsiya.net/blog/2014-11-18-building-memfetch-on-kali/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
